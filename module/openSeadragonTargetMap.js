const t=function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)},e=function(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t},i=function(t){return t&&(t.getRootNode()instanceof Document||t.getRootNode()instanceof ShadowRoot)},n=function(t,i,n){this.name="TargetPatch",this.element=document.createElement("targetPatch"),this.element.style.left=`${100*t.location.x/n.x}%`,this.element.style.top=`${100*t.location.y/n.y}%`,this.element.style.width=`${100*t.location.w/n.x}%`,this.element.style.height=`${100*t.location.h/n.y}%`,i.appendChild(this.element);let a={};for(let[i,n]of Object.entries(t))e(n)&&(a[i]=n);t.reference&&(a.reference=t.reference),t.validity&&(a.validity=t.validity),this.element.dataset.picturaeTargetmapDisplay=JSON.stringify(a)},a=function(t,i,a){if(this.name="TargetChart",this.element=document.createElement("targetChart"),this.element.style.left=`${100*t.location.x/a.x}%`,this.element.style.top=`${100*t.location.y/a.y}%`,this.element.style.width=`${100*t.location.w/a.x}%`,this.element.style.height=`${100*t.location.h/a.y}%`,t.location.r&&180===t.location.r){this.element.style.transformOrigin="center center";const e=`rotate(${t.location.r}deg)`;this.element.style.transform=e}i.appendChild(this.element);let o={};for(let[i,n]of Object.entries(t))e(n)&&(o[i]=n);t.validity&&(o.validity=t.validity),this.element.dataset.picturaeTargetmapDisplay=JSON.stringify(o),this.patches=[];const s={x:t.location.w,y:t.location.h};t.colorPatches&&t.colorPatches.forEach(t=>{t.patchType="color",this.patches.push(new n(t,this.element,s))}),t.edgePatches&&t.edgePatches.forEach(t=>{t.patchType="edge",this.patches.push(new n(t,this.element,s))})},o=function(t){this.name="TargetPatch";const n=document.body,a=document.createElement("table");this.element=a,a.className="picturae-targetmap-display";t.addEventListener("mouseover",(function(t){const o=t.target.tagName&&t.target.tagName||"";"TARGETCHART"===o||"TARGETPATCH"===o?function(t){const o=t.target.dataset.picturaeTargetmapDisplay;if(o){a.innerHTML="";const t=JSON.parse(o);let s="";if(t.patchType&&"color"===t.patchType){s=`<targetColor style="background: ${`rgb(${t.R}, ${t.G}, ${t.B})`};"/>`}a.innerHTML+=`<caption>\n                ${t.name} ${s}\n            </caption>`;for(let[i,n]of Object.entries(t)){let t="";e(n)&&"name"!==i&&(t=`<tr><th>${i}</th><td>${n}</td></tr>`),t&&(a.innerHTML+=t)}i(a)||n.appendChild(a)}}(t):i(a)&&n.removeChild(a),t.stopPropagation()})),t.addEventListener("mousemove",(function(t){t.clientX/n.clientWidth<.5?(a.style.left=`${t.clientX+16}px`,a.style.right="auto"):(a.style.left="auto",a.style.right=`${n.clientWidth-t.clientX+16}px`);const e=t.clientY/n.clientHeight;e<.333?(a.style.top=`${t.clientY+16}px`,a.style.bottom="auto"):e<.666?(a.style.top=`${(n.clientHeight-a.clientHeight)/2}px`,a.style.bottom="auto"):(a.style.top="auto",a.style.bottom=`${n.clientHeight-t.clientY+16}px`),t.stopPropagation()}))},s=function(e){this.name="TargetMap",this.element=document.createElement("targetmap"),e.canvas.appendChild(this.element),this.resize=()=>{if(this.tiledImage=e.world.getItemAt(0),!this.tiledImage)return;const i=this.tiledImage.getBounds(),n=e.viewport.pixelFromPoint(i.getTopLeft()),a=e.viewport.pixelFromPoint(i.getBottomRight());if(!function(){let t=Boolean(arguments.length);return Array.from(arguments).forEach(e=>{t=t&&"number"==typeof e&&Number.isFinite(e)}),t}(n.x,n.y,a.x,a.y))return;const o=t(n.x,4),s=t(n.y,4),r=t(a.x-n.x,4),l=t(a.y-n.y,4);this.element.style.left=`${o}px`,this.element.style.top=`${s}px`,this.element.style.width=`${r}px`,this.element.style.height=`${l}px`},e.addHandler("animation",()=>{this.resize()}),e.addHandler("open",()=>{this.resize()}),e.addHandler("rotate",()=>{this.resize()}),e.addHandler("resize",()=>{this.resize()}),this.resize(),this.charts=[],this.render=t=>{t.targets.forEach(t=>{this.charts.push(new a(t,this.element,this.tiledImage.getContentSize()))})},new o(this.element)};var r=function(){var t=window.OpenSeadragon;if(!t&&!(t=require("openseadragon")))throw new Error("OpenSeadragon is missing.");t.Viewer.prototype.targetMap=function(){return this._targetMap||(this._targetMap=new s(this)),this._targetMap}}();export default r;
//# sourceMappingURL=openSeadragonTargetMap.js.map
