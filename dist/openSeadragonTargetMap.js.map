{"version":3,"file":"openSeadragonTargetMap.js","sources":["../src/functions.js","../src/targetMap.js","../src/index.js"],"sourcesContent":["/**\n * Test for values with which calculations can be done\n * @private\n * @param {arguments} anonymus - one or more values to test\n * @returns {boolean} is a useable number\n */\nconst isUsableNumber = function() {\n    let isUsable = Boolean(arguments.length)\n    Array.from(arguments).forEach(value => {\n        isUsable =\n            isUsable && typeof value === 'number' && Number.isFinite(value)\n    })\n    return isUsable\n}\n\n/**\n * Round at decimals\n * @private\n * @param {number} number - any number to round\n * @param {number} decimals - number of decimals to round at\n * @returns {number} the rounded number\n */\nconst roundAt = function(number, decimals) {\n    // https://www.jacklmoore.com/notes/rounding-in-javascript/\n    return Number(Math.round(number + 'e' + decimals) + 'e-' + decimals)\n}\n\nexport { isUsableNumber, roundAt }\n","import { isUsableNumber, roundAt } from './functions'\n\nconst TargetMap = function(viewer) {\n    this.name = 'TargetMap'\n    this.element = document.createElement('targetmap')\n    this.element.style.position = 'absolute'\n    this.element.style.boxShadow = 'inset 0 0 2px 2px blue'\n\n    viewer.canvas.appendChild(this.element)\n\n    this.resize = () => {\n        const tiledImage = viewer.world.getItemAt(0)\n        if (!tiledImage) return\n        const imageBounds = tiledImage.getBounds()\n\n        const leftTop = viewer.viewport.pixelFromPoint(imageBounds.getTopLeft())\n        const rightBottom = viewer.viewport.pixelFromPoint(\n            imageBounds.getBottomRight(),\n        )\n\n        if (!isUsableNumber(leftTop.x, leftTop.y, rightBottom.x, rightBottom.y))\n            return\n\n        const left = roundAt(leftTop.x, 3)\n        const top = roundAt(leftTop.y, 3)\n        const right = roundAt(rightBottom.x, 3)\n        const bottom = roundAt(rightBottom.y, 3)\n\n        this.element.style.left = `${left}px`\n        this.element.style.top = `${top}px`\n        this.element.style.width = `${right - left}px`\n        this.element.style.height = `${bottom - top}px`\n    }\n\n    viewer.addHandler('animation', () => {\n        this.resize()\n    })\n    viewer.addHandler('open', () => {\n        this.resize()\n    })\n    viewer.addHandler('rotate', () => {\n        this.resize()\n    })\n    viewer.addHandler('resize', () => {\n        this.resize()\n    })\n\n    this.resize()\n}\n\nexport { TargetMap }\n","import { TargetMap } from './targetMap'\n\nvar index = (function() {\n    var $ = window.OpenSeadragon\n\n    if (!$) {\n        $ = require('openseadragon')\n        if (!$) {\n            throw new Error('OpenSeadragon is missing.')\n        }\n    }\n\n    $.Viewer.prototype.targetMap = function() {\n        if (!this._targetMap) {\n            this._targetMap = new TargetMap(this)\n        }\n        return this._targetMap\n    }\n})()\n\nexport default index\n"],"names":["roundAt","number","decimals","Number","Math","round","TargetMap","viewer","this","name","element","document","createElement","style","position","boxShadow","canvas","appendChild","resize","tiledImage","world","getItemAt","imageBounds","getBounds","leftTop","viewport","pixelFromPoint","getTopLeft","rightBottom","getBottomRight","isUsable","Boolean","arguments","length","Array","from","forEach","value","isFinite","isUsableNumber","x","y","left","top","right","bottom","width","height","addHandler","$","window","OpenSeadragon","require","Error","Viewer","prototype","targetMap","_targetMap"],"mappings":"6MAMA,MAgBMA,EAAU,SAASC,EAAQC,GAE7B,OAAOC,OAAOC,KAAKC,MAAMJ,EAAS,IAAMC,GAAY,KAAOA,ICtBzDI,EAAY,SAASC,GACvBC,KAAKC,KAAO,YACZD,KAAKE,QAAUC,SAASC,cAAc,aACtCJ,KAAKE,QAAQG,MAAMC,SAAW,WAC9BN,KAAKE,QAAQG,MAAME,UAAY,yBAE/BR,EAAOS,OAAOC,YAAYT,KAAKE,SAE/BF,KAAKU,OAAS,KACV,MAAMC,EAAaZ,EAAOa,MAAMC,UAAU,GAC1C,IAAKF,EAAY,OACjB,MAAMG,EAAcH,EAAWI,YAEzBC,EAAUjB,EAAOkB,SAASC,eAAeJ,EAAYK,cACrDC,EAAcrB,EAAOkB,SAASC,eAChCJ,EAAYO,kBAGhB,IDde,WACnB,IAAIC,EAAWC,QAAQC,UAAUC,QAKjC,OAJAC,MAAMC,KAAKH,WAAWI,QAAQC,IAC1BP,EACIA,GAA6B,iBAAVO,GAAsBlC,OAAOmC,SAASD,KAE1DP,ECQES,CAAef,EAAQgB,EAAGhB,EAAQiB,EAAGb,EAAYY,EAAGZ,EAAYa,GACjE,OAEJ,MAAMC,EAAO1C,EAAQwB,EAAQgB,EAAG,GAC1BG,EAAM3C,EAAQwB,EAAQiB,EAAG,GACzBG,EAAQ5C,EAAQ4B,EAAYY,EAAG,GAC/BK,EAAS7C,EAAQ4B,EAAYa,EAAG,GAEtCjC,KAAKE,QAAQG,MAAM6B,KAAO,GAAGA,MAC7BlC,KAAKE,QAAQG,MAAM8B,IAAM,GAAGA,MAC5BnC,KAAKE,QAAQG,MAAMiC,MAAQ,GAAGF,EAAQF,MACtClC,KAAKE,QAAQG,MAAMkC,OAAS,GAAGF,EAASF,OAG5CpC,EAAOyC,WAAW,YAAa,KAC3BxC,KAAKU,WAETX,EAAOyC,WAAW,OAAQ,KACtBxC,KAAKU,WAETX,EAAOyC,WAAW,SAAU,KACxBxC,KAAKU,WAETX,EAAOyC,WAAW,SAAU,KACxBxC,KAAKU,WAGTV,KAAKU,iBC7CG,WACR,IAAI+B,EAAIC,OAAOC,cAEf,IAAKF,KACDA,EAAIG,QAAQ,kBAER,MAAM,IAAIC,MAAM,6BAIxBJ,EAAEK,OAAOC,UAAUC,UAAY,WAI3B,OAHKhD,KAAKiD,aACNjD,KAAKiD,WAAa,IAAInD,EAAUE,OAE7BA,KAAKiD,YAdR"}